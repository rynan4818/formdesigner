### Formdesigner for VisualuRuby project     010720 ###
###             うみのひばーじょん(β)              ###

                                     Yukimi_Sake GHE01746@nifty.ne.jp

口上：

Rubyはいわずと知れた、まつもとゆきひろさん作の、純オブジェクト指向プロ
グラミング言語です。

ことオブジェクトの扱いやすさについては数ある言語の中でもトップクラスと
いうのが定評ですから、これをGUIプログラミングに使わない手はない、とお
思いの方も数多くいらっしゃることでしょう。

元もとの開発環境がLinuxですのでTK/GTKではある程度の環境が揃いつつあり
ますが、Windowsに関してはつい１年少し前まではわたなべひろふみさん作の
Win32APIだけでした。(これにしても大変なご尽力があったことと思います）

ただ、いかに優れたブリッジとはいえ、やはりWindowsAPIを直接使うのは、
それなりの根性と、体力が必要です。また、メッセージ処理やコールバック
のようにWin32API単体ではどうにもならないこともあります。ところが、こ
こへきてProject Apollo、そしてVisualuRuby計画と、相次いでGUI志向のプ
ロジェクトが大きな発展をみせています。

このうちApolloは、もうすぐ本も出版されますし、ご存知の方も多いと思いま
すが、DelphiのVCL(Visual Componet Library)及びDelphiで作ったライブラリ
をRubyのオブジェクトとして使っちゃおうという極めてアグレッシブな試みで
すばらしい成果を上げています。
URLはこちら：http://www.users.yun.co.jp/~moriq/apollo/

また、VisualuRubyはネイティブのWindowsAPIからRubyのオブジェクトとして
使えるウインドウやコントロールを直接作っちゃおう、というこれまた大変大
胆な試みです。
URLはこちら：http://www.threeweb.ad.jp/~nyasu/software/vrproject.html

なお、この二つともムックが発売されました。
VisualuRubyは「Rubyを256+倍使うための本 　場外乱闘編」
ISBN 4-7561-3809-8

Apolloは     「Rubyを256+倍使うための本 　紅玉制覇編」
ISBN 4-7561-3810-1

Apolloは8月10日に 「Rubyを256倍使うための本   太陽編」
も発売されます。

今回、このうちVisualuRubyの作者(プロジェクトリーダーかな？)にゃすさん
の「VBみたいなRubyができないかな」という言葉に惹かれたのと、GUIビルダ
のサンプルがホームページのライブラリにあったので、これをお手本にさせて
いただいて、VisualuRubyのための"FormDesigner"なるものを作ってみました。
一応見た目はVBというより、私はDlphi使いですので、DelphiのIDEに近いです
が、もちろん大企業が商用に作ったものとは比べるべくもなく、機能は極めて
限られています。まぁ、ふーん、こんなことできるんだぁ・・くらいのノリで
試していただければ幸いです。

できること：
  フォームを作る
  フォームにコントロールを乗せる
  パネルやグループボックスのようなコンテナにコントロールを乗せる
  コントロールの移動、サイズ変更(ドラッグ＆ドロップ、Inspectウインド
  ウでの値変更)、削除(右クリック)
  コントロールの一部の属性の変更(caption,name)
  コントロールのフォント変更(右クリック)
  コントロールのスタイルの変更(右クリック)
  テンプレートになったメニューを乗せる(現在テンプレートは１種類のみ）
  現状のスクリプトの確認、実行(ユーザーコードも動きます)
  以上をruby ソースファイルとして読み書きする
  エディタを起動して編集する(エディタはPreferenceで好きなのを選択可能)
  コントロール固有のイベントをクリップボードに書き出す(Eventタブ)
  (mix-in 分はまだ）
  ビットマップリソース作成用のツールが一つ
  たったこれだけ

できないこと：
  これ以外全部(^^;
  (つまり、あとはVisualuRuby使ってね。簡単だから)

これからやろうとしてること：
  todo.txt に書いときました。(順不同)

必要なバージョン：
  Ruby  1.6.2 以降(cygwin 版では1.6.1 だとうまく動かないらしい）
    でcygwin,mingw,mswin の各版のいずれか
  vruby 010612以降(Rubyスクリプトで書かれたVisualuRubyの本体)
  swin  010616以降(WindowsAPI からフォームやコントロールを作るDLL)
    で各版に適合したバイナリ

※ご自分でmake-install できる実力のある方は、以降の「インストール」を
  読む必要はありません

インストール：
  ※現在の版はαにも満たない中途半端なものですのでインストーラの類は
  つけません。将来はつけたいですが。

  Ruby は1.6.2以降がインストールしてあるのが前提の話。
  mswin版ではAcriveScriptRuby1.6.4.2以降がおすすめ。
  http://www.geocities.co.jp/SiliconValley-PaloAlto/9251/ruby
  注意：ネスケでダウンロードしちゃだめよ！

  適当なディレクトリでfdvr0707.lzh を解凍します。

  ディレクトリ内に、以下のファイルができます
    FormDesigner.rb   スクリプト本体
    fdcfg.rc          設定用のモジュールを独立させたもの
    todo.txt          とど(なんじゃ？)
    readme.txt        よんでね(このドキュメント)
    vruby010716.lzh   vruby スクリプト群の最新版
    ====以下はStable Version ではなくなります====
    pp.rb             パーサ本体(ソースファイルを解析する)
    inner.rb          パーサの実行部
    parse.y           パーサ定義部(実行には必要ありません)
    files.txt         ファイル入出力の制限について
    commonDlg.rb      まだ動きませんm(_ _;)m

  ActiveScriptRuby1.6.4.2以降をご使用の方は、そのまま動きますので
  最新のvrubyが欲しくなければ以下を読む必要はありません。

  FormDesignerは最新のvrubyを要求しますのでvruby010716.lzhを適当な
  ディレクトリに展開してvrinstall.rbを実行してインストールするか、
  Ruby/lib/site_ruby/1.6/vr以下のスクリプト群を最新のものに置き換
  えて下さい。(ディレクトリが無ければそのままコピー)

  さらに、FormDesignerはswin010616以降をを必要とします。バイナリは
  ActiveScriptRuby1.6.4.2以降であれば、swin010616がインストールされて
  います。但し、vr,swin 共最新を入手するように心がけて下さい。新しい
  ものほど安定して動きます。
  また、cygwin版はにゃすさんのホームページ、または中田さんの"Ruby on
  Windows - 海賊課"
  (http://www.geocities.co.jp/SiliconValley-Bay/4076/)
  で入手できます、同じサイトにmswin版の最新のswinもあります
  ※このところ更新されてませんので、ご注意を

  バイナリを入手したら、Ruby/lib/site_ruby/1.6/i586-mswin32/などに
  解凍して上書きコピーして下さい。

うごかしてみる：
  Ruby/binディレクトリにパスが通っていれば、コンソールから
  "ruby FormDesigner.rb" [ENTER]
  で三つのウィンドウを持った画面が現れます。あとは適宜ツールバーのボ
  タンやら、Inspectウインドウやら、メニューやらをいじくりまわして、
  遊んで下さい。VBやDelphiをお使いの方はすぐに分かると思います。
  あ、２つだけ。

  今回の配布は一応ベータ扱いとしますです。ただし、バグは機能が増えた
  分増加していると思います。Raccはその後クレームが来てないので多分大
  丈夫なんでしょう。(一応ランタイム不要にしてあります)

  あと何かを選択しても何の反応もないのはバグではありません(^^;。単に
  その処理を実装してないだけです。(一部"sorry"メッセージボックスの出る
  のもありますが)そういうのは実装間近なのだなと善意に解釈して下さい。
  (^^;;

そのあとは：
  初めての方はまず、にゃすさんのHPを訪れて下さい。そこのサンプルやら
  リファレンスやらをDLしたり、ブックマークしたりして、いろいろ試しなが
  ら覚えましょう。また、vr(Ruby スクリプト)のソースにもRD形式のリファ
  レンスが入ってます。(まさに「ソースを読め！」ですな)

あっと、ご質問、ご意見、バグレポートなどなど：
  私は現在のところ、HP公開してませんし、にゃすさんの方もBBS,MLはありま
  せん。niftyにアクセスできる方は、極力FGALTSの5番会議室
  (nifty:FGALTS/MES/5)をご利用ください。Webオンリーの方は冒頭のアドレ
  スにメールを送って頂いても構いませんがご返事できないこともあり得ま
  す。でも、お気を悪くなさらないでくださいね。あまりMailが多くなるよう
  でしたら少し考えますので。(ってぜんぜん無反響だったらどーしよう^^;)
  あ、soureceforge にForumが出来ました。発言するには、登録が必要ですが
  簡単ですし、無料です。
  URL:  http://sourceforge.net/projects/vruby/

さらに、ああっと、ライセンスなど：
  当然 Ruby ライセンスに従います。"Ruby ライセンス"ってなに？という方
  は本家へ行って原文を読んでください。私の説明では誤解を招く恐れがあり
  ますので。
  本家のURL：http://www.ruby-lang.org/ja/

ありがとう：
  Rubyの生みの親、まつもとゆきひろさん、Windowsへのポーティングをして
  くださった皆さん、Raccのあおきさん、ActiveScriptRubyのartonさん、
  そして、VisualuRuby計画のにゃすさん、そしてそしてRubyの普及に日夜尽
  力しておられる皆さん、ありがとうございます。

では、いろいろ試して楽しんでください。(^-^)/~~
                                                     2001/07/20 雪見酒
