###         FormDesigner for VisualuRuby project     040417       ###
###                                                               ###

                                     mailto:yukimi_sake@mbi.nifty.com
                              http://homepage3.nifty.com/Yukimi_Sake/
口上： 

  光陰矢の如しとは良く言ったもので２年以上の月日が経ってしまいました。
  その後VisualuRubyもApolloも順調に発展していますが、FormDesignerは
  停滞したままでした。このままじゃいかん！というわけでアップデイトを
  敢行いたしました。但し、この版は暫定版です。まだいくらか作業が残って
  いますし、バグも取りきっていません。使用なさる方は心しておいてくださ
  い。開発経緯についてはreadme.old.txt を添付してありますのでそちらを
  お読みください。さて、能書きはこれくらいにしておいて、本題に入ります。

大前提：

  この版はのvruby031014以降でのみ動作します。(ただし最新のを極力使用し
  てください。)にゃすさんのホームページからダウンロードしてインストール
  してください。
  http://www.osk.3web.ne.jp/~nyasu/software/vrproject.html

  また、旧版で編集したファイルは多くの場合、読み込むことができません。
  というのは、FormDesignerで編集したForm固有のファイルはアプリケーショ
  ン本体と分離したからです。旧版ではかなりの確率で手作業編集をしたファ
  イルが開けなくなりましたが、この版ではそういうことがなくなるはずです。
  もし開けなければそれはFormDesignerのバグですから、私にご連絡いただけ
  れば、できる限り対応します。

  分離の方法は以下のようになっています。

  FormDesignerで編集したファイルは、"_frm_hoge.rb"のように"_frm_"という
  プリフィクスがつきます。FormDesignerはこのプリフィクスのついたファイ
  ルを自分が作ったファイルだと識別して開きます。これ以外のファイルは開
  きません。一方あなたが編集するべきファイルは"プロジェクト"と呼びます。
  FormDesignerはこのプロジェクトのモジュール定義やrequire定義などを自動
  的に作成して雛型ファイルを出力します。こちらは名前の制限がありませんが、
  同名で、前述のプリフィクスのついたファイルも同時に出力します。
  つまり、あなたのプロジェクト本体はエディタで、Formファイルの編集は
  FormDesignerでと作業分担がはっきり分かれました。

  以上ご承知おきください。

できること：
  フォームを作る
  フォームにコントロールを乗せる
  パネルやグループボックスのようなコンテナにコントロールを乗せる
  コントロールの移動、サイズ変更(ドラッグ＆ドロップ、Inspectウインド
  ウでの値変更)、削除(右クリック)
  コントロールの一部の属性の変更(caption,name)
  コントロールのフォント変更(Inspectウインウからボタンで）
  コントロールのスタイルの変更(Inspectウインウからボタンで）
  テンプレートになったメニューを乗せる(現在テンプレートは１種類のみ）
  メニューを編集する(Inspectウインウからボタンで）
  ポップアップメニューを編集する(Inspectウインウからボタンで）
  ToolbarやTabbedPanelなどアイテムを持つコントロールのアイテム編集(同)
  現状のスクリプトの確認、実行(ユーザーコードは動きません)
  コントロールに一部のモジュールを追加する。
  moduleになっている、コモンダイアログのメソッド引数の編集
  以上をruby ソースファイルとして読み書きする
  エディタを起動して編集する(エディタはPreferenceで好きなのを選択可能)
  コントロール固有のイベントをクリップボードに書き出す。
  メソッドもクリップボードに書き出す。
  上記二つはFormDesignerからエディタを起動している場合はダブルクリック
  でエディタに制御が移る
  ユーザーコード別置型にしたので、ユーザーコードの雛型を出力
  ユーザーコード編集中にモジュールをジュールを必要とするコントロールを
  追加した場合、ユーザーコードに反映させることができる
  ビットマップリソース作成用のツールが一つ

  と、まあ以前よりは機能が増えたし、多少使いやすくなっています。

まだできてないこと：
  ImageListの実装、Tooltipの実装、レイアウトマネージャ、copy/pasteの
  実装、マニュアル、、コントロール追加モジュールの拾い出しなどなど
  まだまだ多数。

必要なバージョン：

  Ruby  1.8.0 以降でcygwin,mingw,mswin の各版のいずれか
  swin  (WindowsAPI からフォームやコントロールを作るDLL)040314以降
    で各版に適合したバイナリ
  vruby (Rubyスクリプトで書かれたVisualuRubyの本体)上述のように
  0040306以降。
  作成したアプリケーションでToolbarを使用している場合はcheckoutバージョ
  ンより前のvrubyで動作させる場合、tooltipが使えないなど、若干の注意が
  必要になる場合があります。(実装してないから大丈夫か...)

インストール：

  Ruby は1.8.0以降がインストールしてあるのが前提の話。
  mswin版ではActiveScriptRuby1.8.1.1以降がおすすめ。
  http://www.geocities.co.jp/SiliconValley-PaloAlto/9251/ruby
  注意：ネスケでダウンロードしちゃだめよ！

  適当なディレクトリでアーカイブを解凍します。(cvsをチェックアウトし
  た場合はそのままディレクトリになっている)

  vruby031014lzhを解凍してインストールします。解凍するとディレクトリ
  内のトップにvrinstall.rbがありますので、それを実行してください。
  ActiveScriptRubyをインストールしている場合は、このファイルのダブル
  クリックでインストールが始まります。そうでない場合はコマンドライン
  から解凍したディレクトリ内でruby vrinstall.rb とします。
  もしくは私のホームページに最新版のswinとvrubyがインストーラつきで
  用意してありますから、それをインストールしても良いでしょう。

うごかしてみる：

  Ruby/binディレクトリにパスが通っていれば、コンソールからFormDesigner
  を解凍したディレクトリで

  "ruby FormDesigner.rb" [ENTER]

  で三つのウィンドウを持った画面が現れます。ActiveScriptRubyならエク
  スプローラからこのファイルをダブルクリックするだけです。あとは適宜
  ツールバーのボタンやら、Inspectウインドウやら、メニューやらをいじく
  りまわして、遊んで下さい。VBやDelphiをお使いの方はすぐに分かると思
  います。あ、２つだけ。

  今回の配布は一応ベータ扱いとしますです。ただし、バグは機能が増えた
  分増加していると思います。

  あと何かを選択しても何の反応もないのはバグではありません(^^;。単に
  その処理を実装してないだけです。(一部"sorry"メッセージボックスの出る
  のもありますが)そういうのは実装間近なのだなと善意に解釈して下さい。
  (^^;;

そのあとは：
  初めての方はまず、にゃすさんのHPを訪れて下さい。そこのサンプルやら
  リファレンスやらをDLしたり、ブックマークしたりして、いろいろ試しなが
  ら覚えましょう。また、vr(Ruby スクリプト)のソースにもRD形式のリファ
  レンスが入ってます。(まさに「ソースを読め！」ですな)

あっと、ご質問、ご意見、バグレポートなどなど：
  冒頭のアドレスにメールをいただければ何らかのリアクションがあります。
  たいていは私のHPの日記に引用した上で回答、お返事をすることになりま
  す。但し、必要に応じて直接ご返信することもありえます。
  また、ruby listは購読しておりますので、そちらに上げていただければ、そ
  ちらでお返事いたします。
  soureceforge のForumでも結構ですが、ちょっと巡回頻度が低いです。
  URL:  http://sourceforge.net/projects/vruby/
  nifty:FGALTSはさらに巡回頻度が低いです。

さらに、ああっと、ライセンスなど：
  当然 Ruby ライセンスに従います。"Ruby ライセンス"ってなに？という方
  は本家へ行って原文を読んでください。私の説明では誤解を招く恐れがあり
  ますので。
  本家のURL：http://www.ruby-lang.org/ja/

ありがとう：
  Rubyの生みの親、まつもとゆきひろさん、Windowsへのポーティングをして
  くださった皆さん、Raccのあおきさん、ActiveScriptRubyのartonさん、
  そして、VisualuRuby計画のにゃすさん、そしてそしてRubyの普及に日夜尽
  力しておられる皆さん、ありがとうございます。

では、いろいろ試して楽しんでください。(^-^)/~~
なお、変更履歴はhistory.txtに記載してあります。
                                                     2004/4/17 雪見酒
